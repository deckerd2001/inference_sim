=======================================================================
LLM Inference Simulator - TP Scaling Benchmark
=======================================================================
Start Time: 2025. 12. 08. (Ïõî) 18:04:45 PST
Random Seed: 18782

‚ö†Ô∏è  Note: Only TP (Tensor Parallelism) is implemented

Configuration:
  Model:           llama2-70b
  xPUs:            a100-80gb h100-80gb mi300x
  Arrival Rate:    10.0 req/s
  Duration:        60.0s

Testing 3 xPUs √ó 4 TP configs = 12 total tests
=======================================================================

-----------------------------------------------------------------------
[1/12] Testing: a100-80gb - TP=1
  Cluster: 1 xPUs (TP=1)
-----------------------------------------------------------------------
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/deckerd/my_projects/inference_sim/llm_inference_simulator/__main__.py", line 219, in <module>
    sys.exit(main())
             ^^^^^^
  File "/home/deckerd/my_projects/inference_sim/llm_inference_simulator/__main__.py", line 203, in main
    config = create_config_from_args(args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/deckerd/my_projects/inference_sim/llm_inference_simulator/__main__.py", line 83, in create_config_from_args
    return SimulatorConfig(
           ^^^^^^^^^^^^^^^^
  File "<string>", line 12, in __init__
  File "/home/deckerd/my_projects/inference_sim/llm_inference_simulator/config.py", line 113, in __post_init__
    self.validate()
  File "/home/deckerd/my_projects/inference_sim/llm_inference_simulator/config.py", line 212, in validate
    raise ValueError(error_msg.strip())
ValueError: Configuration validation failed:
  1. Model weights (130.39GB per xPU with TP=1) exceed xPU memory (80.0GB). Increase tensor_parallel_size or use larger xPUs.
‚úó Failed
  Error: 1. Model weights (130.39GB per xPU with TP=1) exceed xPU memory (80.0GB). Increase tensor_parallel_size or use larger xPUs.

-----------------------------------------------------------------------
[2/12] Testing: a100-80gb - TP=2
  Cluster: 2 xPUs (TP=2)
-----------------------------------------------------------------------

Starting simulation...
Starting simulation...
Configuration: LLaMA-2-70B, 2 xPUs, arrival_rate=10.0 req/s
Memory: 65.19GB model, 14.81GB available for KV cache

Simulation completed at t=60.01s

============================================================
SIMULATION SUMMARY
============================================================

Load Analysis:
  Arrival Rate:         10.0 req/s
  Avg Output Length:    192 tok/req
  Required Throughput:  1920 tok/s
  Actual Throughput:    135.3 tok/s
  Utilization:          1419% ‚ö†Ô∏è  OVERLOAD

------------------------------------------------------------
Metrics Reliability:
  ‚úÖ Throughput:    System capacity (reliable)
  ‚úÖ Completion:    Capacity/Load ratio (reliable)
  ‚ùå TTFT/Latency:  Unreliable (early arrivals only)
------------------------------------------------------------

Requests:
  Total: 627
  Completed: 62

Throughput (= System Capacity):
  Requests/sec: 1.03
  Tokens/sec: 135.34

xPU Utilization: 100.0%

Memory Usage:
  Peak:        80.00GB / 160GB (50.0%)
  P95:         79.96GB / 160GB (50.0%)
  P50 (Med):   77.23GB / 160GB (48.3%)

First Token Latency (‚ö†Ô∏è  Not representative - early arrivals only):
  Mean: 24.5133
  P50:  23.9067
  P90:  46.7634
  P95:  46.8666
  P99:  47.0397

End-to-End Latency (‚ö†Ô∏è  Not representative):
  Mean: 28.7885
  P50:  29.0821
  P90:  50.9718
  P95:  51.9829
  P99:  52.6902

Recommendation:
  System cannot handle workload (14.2x overloaded)
  For stable operation: Reduce arrival to 0.6 req/s (80% util)

============================================================

‚úì Results saved to: results/cluster_benchmark_20251208_180445/a100-80gb_2xpu_tp2.json
‚úì Completed successfully
  Throughput: 135.3 tok/s, Completed: 62, P95 TTFT: 46.87s

-----------------------------------------------------------------------
[3/12] Testing: a100-80gb - TP=4
  Cluster: 4 xPUs (TP=4)
-----------------------------------------------------------------------

Starting simulation...
Starting simulation...
Configuration: LLaMA-2-70B, 4 xPUs, arrival_rate=10.0 req/s
Memory: 32.60GB model, 47.40GB available for KV cache

Simulation completed at t=60.01s

============================================================
SIMULATION SUMMARY
============================================================

Load Analysis:
  Arrival Rate:         10.0 req/s
  Avg Output Length:    192 tok/req
  Required Throughput:  1920 tok/s
  Actual Throughput:    386.0 tok/s
  Utilization:          497% ‚ö†Ô∏è  OVERLOAD

------------------------------------------------------------
Metrics Reliability:
  ‚úÖ Throughput:    System capacity (reliable)
  ‚úÖ Completion:    Capacity/Load ratio (reliable)
  ‚ùå TTFT/Latency:  Unreliable (early arrivals only)
------------------------------------------------------------

Requests:
  Total: 627
  Completed: 174

Throughput (= System Capacity):
  Requests/sec: 2.90
  Tokens/sec: 385.98

xPU Utilization: 100.0%

Memory Usage:
  Peak:        79.92GB / 320GB (25.0%)
  P95:         79.59GB / 320GB (24.9%)
  P50 (Med):   65.58GB / 320GB (20.5%)

First Token Latency (‚ö†Ô∏è  Not representative - early arrivals only):
  Mean: 21.9521
  P50:  21.8460
  P90:  39.2168
  P95:  40.0054
  P99:  40.6089

End-to-End Latency (‚ö†Ô∏è  Not representative):
  Mean: 24.2480
  P50:  24.4326
  P90:  38.6444
  P95:  40.3555
  P99:  42.8162

Recommendation:
  System cannot handle workload (5.0x overloaded)
  For stable operation: Reduce arrival to 1.6 req/s (80% util)

============================================================

‚úì Results saved to: results/cluster_benchmark_20251208_180445/a100-80gb_4xpu_tp4.json
‚úì Completed successfully
  Throughput: 386.0 tok/s, Completed: 174, P95 TTFT: 40.01s

-----------------------------------------------------------------------
[4/12] Testing: a100-80gb - TP=8
  Cluster: 8 xPUs (TP=8)
-----------------------------------------------------------------------

Starting simulation...
Starting simulation...
Configuration: LLaMA-2-70B, 8 xPUs, arrival_rate=10.0 req/s
Memory: 16.30GB model, 63.70GB available for KV cache

Simulation completed at t=60.03s

============================================================
SIMULATION SUMMARY
============================================================

Load Analysis:
  Arrival Rate:         10.0 req/s
  Avg Output Length:    192 tok/req
  Required Throughput:  1920 tok/s
  Actual Throughput:    571.7 tok/s
  Utilization:          336% ‚ö†Ô∏è  OVERLOAD

------------------------------------------------------------
Metrics Reliability:
  ‚úÖ Throughput:    System capacity (reliable)
  ‚úÖ Completion:    Capacity/Load ratio (reliable)
  ‚ùå TTFT/Latency:  Unreliable (early arrivals only)
------------------------------------------------------------

Requests:
  Total: 627
  Completed: 251

Throughput (= System Capacity):
  Requests/sec: 4.18
  Tokens/sec: 571.66

xPU Utilization: 100.0%

Memory Usage:
  Peak:        79.77GB / 640GB (12.5%)
  P95:         79.10GB / 640GB (12.4%)
  P50 (Med):   62.59GB / 640GB (9.8%)

First Token Latency (‚ö†Ô∏è  Not representative - early arrivals only):
  Mean: 16.8553
  P50:  16.7482
  P90:  30.2918
  P95:  31.6585
  P99:  32.3480

End-to-End Latency (‚ö†Ô∏è  Not representative):
  Mean: 19.2313
  P50:  19.2793
  P90:  31.6777
  P95:  32.9122
  P99:  34.1734

Recommendation:
  System cannot handle workload (3.4x overloaded)
  For stable operation: Reduce arrival to 2.4 req/s (80% util)

============================================================

‚úì Results saved to: results/cluster_benchmark_20251208_180445/a100-80gb_8xpu_tp8.json
‚úì Completed successfully
  Throughput: 571.7 tok/s, Completed: 251, P95 TTFT: 31.66s

-----------------------------------------------------------------------
[5/12] Testing: h100-80gb - TP=1
  Cluster: 1 xPUs (TP=1)
-----------------------------------------------------------------------
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/deckerd/my_projects/inference_sim/llm_inference_simulator/__main__.py", line 219, in <module>
    sys.exit(main())
             ^^^^^^
  File "/home/deckerd/my_projects/inference_sim/llm_inference_simulator/__main__.py", line 203, in main
    config = create_config_from_args(args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/deckerd/my_projects/inference_sim/llm_inference_simulator/__main__.py", line 83, in create_config_from_args
    return SimulatorConfig(
           ^^^^^^^^^^^^^^^^
  File "<string>", line 12, in __init__
  File "/home/deckerd/my_projects/inference_sim/llm_inference_simulator/config.py", line 113, in __post_init__
    self.validate()
  File "/home/deckerd/my_projects/inference_sim/llm_inference_simulator/config.py", line 212, in validate
    raise ValueError(error_msg.strip())
ValueError: Configuration validation failed:
  1. Model weights (130.39GB per xPU with TP=1) exceed xPU memory (80.0GB). Increase tensor_parallel_size or use larger xPUs.
‚úó Failed
  Error: 1. Model weights (130.39GB per xPU with TP=1) exceed xPU memory (80.0GB). Increase tensor_parallel_size or use larger xPUs.

-----------------------------------------------------------------------
[6/12] Testing: h100-80gb - TP=2
  Cluster: 2 xPUs (TP=2)
-----------------------------------------------------------------------

Starting simulation...
Starting simulation...
Configuration: LLaMA-2-70B, 2 xPUs, arrival_rate=10.0 req/s
Memory: 65.19GB model, 14.81GB available for KV cache

Simulation completed at t=60.02s

============================================================
SIMULATION SUMMARY
============================================================

Load Analysis:
  Arrival Rate:         10.0 req/s
  Avg Output Length:    192 tok/req
  Required Throughput:  1920 tok/s
  Actual Throughput:    232.6 tok/s
  Utilization:          825% ‚ö†Ô∏è  OVERLOAD

------------------------------------------------------------
Metrics Reliability:
  ‚úÖ Throughput:    System capacity (reliable)
  ‚úÖ Completion:    Capacity/Load ratio (reliable)
  ‚ùå TTFT/Latency:  Unreliable (early arrivals only)
------------------------------------------------------------

Requests:
  Total: 627
  Completed: 105

Throughput (= System Capacity):
  Requests/sec: 1.75
  Tokens/sec: 232.63

xPU Utilization: 100.0%

Memory Usage:
  Peak:        80.00GB / 160GB (50.0%)
  P95:         79.92GB / 160GB (49.9%)
  P50 (Med):   76.65GB / 160GB (47.9%)

First Token Latency (‚ö†Ô∏è  Not representative - early arrivals only):
  Mean: 22.8262
  P50:  20.8213
  P90:  41.4377
  P95:  45.2398
  P99:  45.6003

End-to-End Latency (‚ö†Ô∏è  Not representative):
  Mean: 25.5302
  P50:  24.2488
  P90:  44.1651
  P95:  47.5061
  P99:  48.7426

Recommendation:
  System cannot handle workload (8.3x overloaded)
  For stable operation: Reduce arrival to 1.0 req/s (80% util)

============================================================

‚úì Results saved to: results/cluster_benchmark_20251208_180445/h100-80gb_2xpu_tp2.json
‚úì Completed successfully
  Throughput: 232.6 tok/s, Completed: 105, P95 TTFT: 45.24s

-----------------------------------------------------------------------
[7/12] Testing: h100-80gb - TP=4
  Cluster: 4 xPUs (TP=4)
-----------------------------------------------------------------------

Starting simulation...
Starting simulation...
Configuration: LLaMA-2-70B, 4 xPUs, arrival_rate=10.0 req/s
Memory: 32.60GB model, 47.40GB available for KV cache

Simulation completed at t=60.00s

============================================================
SIMULATION SUMMARY
============================================================

Load Analysis:
  Arrival Rate:         10.0 req/s
  Avg Output Length:    192 tok/req
  Required Throughput:  1920 tok/s
  Actual Throughput:    716.9 tok/s
  Utilization:          268% ‚ö†Ô∏è  OVERLOAD

------------------------------------------------------------
Metrics Reliability:
  ‚úÖ Throughput:    System capacity (reliable)
  ‚úÖ Completion:    Capacity/Load ratio (reliable)
  ‚ùå TTFT/Latency:  Unreliable (early arrivals only)
------------------------------------------------------------

Requests:
  Total: 627
  Completed: 328

Throughput (= System Capacity):
  Requests/sec: 5.47
  Tokens/sec: 716.93

xPU Utilization: 100.0%

Memory Usage:
  Peak:        80.00GB / 320GB (25.0%)
  P95:         79.81GB / 320GB (24.9%)
  P50 (Med):   64.61GB / 320GB (20.2%)

First Token Latency (‚ö†Ô∏è  Not representative - early arrivals only):
  Mean: 13.6232
  P50:  13.9245
  P90:  23.8516
  P95:  24.9650
  P99:  26.3348

End-to-End Latency (‚ö†Ô∏è  Not representative):
  Mean: 16.1264
  P50:  16.1139
  P90:  26.3012
  P95:  27.6056
  P99:  29.3698

Recommendation:
  System cannot handle workload (2.7x overloaded)
  For stable operation: Reduce arrival to 3.0 req/s (80% util)

============================================================

‚úì Results saved to: results/cluster_benchmark_20251208_180445/h100-80gb_4xpu_tp4.json
‚úì Completed successfully
  Throughput: 716.9 tok/s, Completed: 328, P95 TTFT: 24.96s

-----------------------------------------------------------------------
[8/12] Testing: h100-80gb - TP=8
  Cluster: 8 xPUs (TP=8)
-----------------------------------------------------------------------

Starting simulation...
Starting simulation...
Configuration: LLaMA-2-70B, 8 xPUs, arrival_rate=10.0 req/s
Memory: 16.30GB model, 63.70GB available for KV cache

Simulation completed at t=60.01s

============================================================
SIMULATION SUMMARY
============================================================

Load Analysis:
  Arrival Rate:         10.0 req/s
  Avg Output Length:    192 tok/req
  Required Throughput:  1920 tok/s
  Actual Throughput:    1019.2 tok/s
  Utilization:          188% ‚ö†Ô∏è  OVERLOAD

------------------------------------------------------------
Metrics Reliability:
  ‚úÖ Throughput:    System capacity (reliable)
  ‚úÖ Completion:    Capacity/Load ratio (reliable)
  ‚ùå TTFT/Latency:  Unreliable (early arrivals only)
------------------------------------------------------------

Requests:
  Total: 627
  Completed: 470

Throughput (= System Capacity):
  Requests/sec: 7.83
  Tokens/sec: 1019.23

xPU Utilization: 100.0%

Memory Usage:
  Peak:        79.66GB / 640GB (12.4%)
  P95:         78.99GB / 640GB (12.3%)
  P50 (Med):   55.63GB / 640GB (8.7%)

First Token Latency (‚ö†Ô∏è  Not representative - early arrivals only):
  Mean: 6.9454
  P50:  6.6688
  P90:  12.4964
  P95:  13.1391
  P99:  14.3120

End-to-End Latency (‚ö†Ô∏è  Not representative):
  Mean: 9.4221
  P50:  9.4319
  P90:  14.6074
  P95:  15.7169
  P99:  16.9121

Recommendation:
  System cannot handle workload (1.9x overloaded)
  For stable operation: Reduce arrival to 4.2 req/s (80% util)

============================================================

‚úì Results saved to: results/cluster_benchmark_20251208_180445/h100-80gb_8xpu_tp8.json
‚úì Completed successfully
  Throughput: 1019.2 tok/s, Completed: 470, P95 TTFT: 13.14s

-----------------------------------------------------------------------
[9/12] Testing: mi300x - TP=1
  Cluster: 1 xPUs (TP=1)
-----------------------------------------------------------------------

Starting simulation...
Starting simulation...
Configuration: LLaMA-2-70B, 1 xPUs, arrival_rate=10.0 req/s
Memory: 130.39GB model, 61.61GB available for KV cache

Simulation completed at t=60.01s

============================================================
SIMULATION SUMMARY
============================================================

Load Analysis:
  Arrival Rate:         10.0 req/s
  Avg Output Length:    192 tok/req
  Required Throughput:  1920 tok/s
  Actual Throughput:    449.9 tok/s
  Utilization:          427% ‚ö†Ô∏è  OVERLOAD

------------------------------------------------------------
Metrics Reliability:
  ‚úÖ Throughput:    System capacity (reliable)
  ‚úÖ Completion:    Capacity/Load ratio (reliable)
  ‚ùå TTFT/Latency:  Unreliable (early arrivals only)
------------------------------------------------------------

Requests:
  Total: 627
  Completed: 204

Throughput (= System Capacity):
  Requests/sec: 3.40
  Tokens/sec: 449.91

xPU Utilization: 100.0%

Memory Usage:
  Peak:        191.87GB / 192GB (99.9%)
  P95:         191.66GB / 192GB (99.8%)
  P50 (Med):   168.49GB / 192GB (87.8%)

First Token Latency (‚ö†Ô∏è  Not representative - early arrivals only):
  Mean: 20.9608
  P50:  20.1461
  P90:  37.1265
  P95:  38.6830
  P99:  39.2369

End-to-End Latency (‚ö†Ô∏è  Not representative):
  Mean: 22.0420
  P50:  22.1802
  P90:  35.1475
  P95:  36.3639
  P99:  37.2474

Recommendation:
  System cannot handle workload (4.3x overloaded)
  For stable operation: Reduce arrival to 1.9 req/s (80% util)

============================================================

‚úì Results saved to: results/cluster_benchmark_20251208_180445/mi300x_1xpu_tp1.json
‚úì Completed successfully
  Throughput: 449.9 tok/s, Completed: 204, P95 TTFT: 38.68s

-----------------------------------------------------------------------
[10/12] Testing: mi300x - TP=2
  Cluster: 2 xPUs (TP=2)
-----------------------------------------------------------------------

Starting simulation...
Starting simulation...
Configuration: LLaMA-2-70B, 2 xPUs, arrival_rate=10.0 req/s
Memory: 65.19GB model, 126.81GB available for KV cache

Simulation completed at t=60.01s

============================================================
SIMULATION SUMMARY
============================================================

Load Analysis:
  Arrival Rate:         10.0 req/s
  Avg Output Length:    192 tok/req
  Required Throughput:  1920 tok/s
  Actual Throughput:    914.7 tok/s
  Utilization:          210% ‚ö†Ô∏è  OVERLOAD

------------------------------------------------------------
Metrics Reliability:
  ‚úÖ Throughput:    System capacity (reliable)
  ‚úÖ Completion:    Capacity/Load ratio (reliable)
  ‚ùå TTFT/Latency:  Unreliable (early arrivals only)
------------------------------------------------------------

Requests:
  Total: 627
  Completed: 416

Throughput (= System Capacity):
  Requests/sec: 6.93
  Tokens/sec: 914.71

xPU Utilization: 100.0%

Memory Usage:
  Peak:        191.11GB / 384GB (49.8%)
  P95:         191.02GB / 384GB (49.7%)
  P50 (Med):   130.84GB / 384GB (34.1%)

First Token Latency (‚ö†Ô∏è  Not representative - early arrivals only):
  Mean: 9.9618
  P50:  10.2308
  P90:  15.8265
  P95:  17.0718
  P99:  19.7616

End-to-End Latency (‚ö†Ô∏è  Not representative):
  Mean: 12.7837
  P50:  13.1558
  P90:  18.8038
  P95:  20.0251
  P99:  21.0733

Recommendation:
  System cannot handle workload (2.1x overloaded)
  For stable operation: Reduce arrival to 3.8 req/s (80% util)

============================================================

‚úì Results saved to: results/cluster_benchmark_20251208_180445/mi300x_2xpu_tp2.json
‚úì Completed successfully
  Throughput: 914.7 tok/s, Completed: 416, P95 TTFT: 17.07s

-----------------------------------------------------------------------
[11/12] Testing: mi300x - TP=4
  Cluster: 4 xPUs (TP=4)
-----------------------------------------------------------------------

Starting simulation...
Starting simulation...
Configuration: LLaMA-2-70B, 4 xPUs, arrival_rate=10.0 req/s
Memory: 32.60GB model, 159.40GB available for KV cache

Simulation completed at t=60.01s

============================================================
SIMULATION SUMMARY
============================================================

Load Analysis:
  Arrival Rate:         10.0 req/s
  Avg Output Length:    192 tok/req
  Required Throughput:  1920 tok/s
  Actual Throughput:    1211.5 tok/s
  Utilization:          158% ‚ö†Ô∏è  OVERLOAD

------------------------------------------------------------
Metrics Reliability:
  ‚úÖ Throughput:    System capacity (reliable)
  ‚úÖ Completion:    Capacity/Load ratio (reliable)
  ‚ùå TTFT/Latency:  Unreliable (early arrivals only)
------------------------------------------------------------

Requests:
  Total: 627
  Completed: 549

Throughput (= System Capacity):
  Requests/sec: 9.15
  Tokens/sec: 1211.52

xPU Utilization: 100.0%

Memory Usage:
  Peak:        126.32GB / 768GB (16.4%)
  P95:         119.50GB / 768GB (15.6%)
  P50 (Med):   75.32GB / 768GB (9.8%)

First Token Latency (‚ö†Ô∏è  Not representative - early arrivals only):
  Mean: 3.3293
  P50:  3.0799
  P90:  5.4227
  P95:  6.0898
  P99:  6.7774

End-to-End Latency (‚ö†Ô∏è  Not representative):
  Mean: 5.6453
  P50:  5.5953
  P90:  8.1017
  P95:  8.7090
  P99:  9.8221

Recommendation:
  System cannot handle workload (1.6x overloaded)
  For stable operation: Reduce arrival to 5.0 req/s (80% util)

============================================================

‚úì Results saved to: results/cluster_benchmark_20251208_180445/mi300x_4xpu_tp4.json
‚úì Completed successfully
  Throughput: 1211.5 tok/s, Completed: 549, P95 TTFT: 6.09s

-----------------------------------------------------------------------
[12/12] Testing: mi300x - TP=8
  Cluster: 8 xPUs (TP=8)
-----------------------------------------------------------------------

Starting simulation...
Starting simulation...
Configuration: LLaMA-2-70B, 8 xPUs, arrival_rate=10.0 req/s
Memory: 16.30GB model, 175.70GB available for KV cache

Simulation completed at t=60.34s

============================================================
SIMULATION SUMMARY
============================================================

Load Analysis:
  Arrival Rate:         10.0 req/s
  Avg Output Length:    192 tok/req
  Required Throughput:  1920 tok/s
  Actual Throughput:    1265.9 tok/s
  Utilization:          152% ‚ö†Ô∏è  OVERLOAD

------------------------------------------------------------
Metrics Reliability:
  ‚úÖ Throughput:    System capacity (reliable)
  ‚úÖ Completion:    Capacity/Load ratio (reliable)
  ‚ùå TTFT/Latency:  Unreliable (early arrivals only)
------------------------------------------------------------

Requests:
  Total: 627
  Completed: 604

Throughput (= System Capacity):
  Requests/sec: 10.01
  Tokens/sec: 1265.85

xPU Utilization: 100.0%

Memory Usage:
  Peak:        68.02GB / 1536GB (4.4%)
  P95:         55.84GB / 1536GB (3.6%)
  P50 (Med):   36.82GB / 1536GB (2.4%)

First Token Latency (‚ö†Ô∏è  Not representative - early arrivals only):
  Mean: 1.3866
  P50:  1.3553
  P90:  2.2387
  P95:  2.4679
  P99:  2.9386

End-to-End Latency (‚ö†Ô∏è  Not representative):
  Mean: 2.5969
  P50:  2.6522
  P90:  3.6926
  P95:  3.8956
  P99:  4.5198

Recommendation:
  System cannot handle workload (1.5x overloaded)
  For stable operation: Reduce arrival to 5.3 req/s (80% util)

============================================================

‚úì Results saved to: results/cluster_benchmark_20251208_180445/mi300x_8xpu_tp8.json
‚úì Completed successfully
  Throughput: 1265.9 tok/s, Completed: 604, P95 TTFT: 2.47s

=======================================================================
Benchmark Complete!
=======================================================================
End Time: 2025. 12. 08. (Ïõî) 18:04:52 PST

=============================================================================================================================
TP SCALING BENCHMARK REPORT
=============================================================================================================================

Configuration:
-----------------------------------------------------------------------------------------------------------------------------
  Model:           N/A
  xPUs Tested:     N/A
  Workload:        N/A req/s
  Duration:        N/As

Performance & Cost Analysis:
=============================================================================================================================
         xPU  GPUs  TP   Status  Throughput  P95 TTFT     Cost  Efficiency        Cost
                                    (tok/s)     (sec)   ($/hr)   (tok/$/h)   ($/1Mtok)
-----------------------------------------------------------------------------------------------------------------------------
   A100-80GB     1   1   ‚ùå FAIL         N/A       N/A    N/A      N/A         N/A         N/A
   A100-80GB     2   2     ‚úÖ OK       135.3     46.87     7.34        18.4    54235.12
   A100-80GB     4   4     ‚úÖ OK       386.0     40.01    14.68        26.3    38033.08
   A100-80GB     8   8     ‚úÖ OK       571.7     31.66    29.36        19.5    51359.04
   H100-80GB     1   1   ‚ùå FAIL         N/A       N/A    N/A      N/A         N/A         N/A
   H100-80GB     2   2     ‚úÖ OK       232.6     45.24    12.98        17.9    55796.87
   H100-80GB     4   4     ‚úÖ OK       716.9     24.96    25.96        27.6    36210.13
   H100-80GB     8   8     ‚úÖ OK      1019.2     13.14    51.92        19.6    50940.34
      MI300X     1   1     ‚úÖ OK       449.9     38.68     7.00        64.3    15558.58
      MI300X     2   2     ‚úÖ OK       914.7     17.07    14.00        65.3    15305.34
      MI300X     4   4     ‚úÖ OK      1211.5      6.09    28.00        43.3    23111.56
      MI300X     8   8     ‚úÖ OK      1265.9      2.47    56.00        22.6    44239.05
-----------------------------------------------------------------------------------------------------------------------------

üèÜ Recommended Configurations:
-----------------------------------------------------------------------------------------------------------------------------
  üí∞ Best Value (tok/$/hour):
     MI300X: 2 GPUs, TP=2
     65.3 tok/$/hour | $15305.34/1M tokens | 914.7 tok/s

  üöÄ Best Performance (throughput):
     MI300X: 8 GPUs, TP=8
     1265.9 tok/s | $56.00/hour | P95 TTFT: 2.47s

  ‚ö° Best Latency (TTFT):
     MI300X: 8 GPUs, TP=8
     P95 TTFT: 2.47s | 1265.9 tok/s | $56.00/hour


‚ùå Failed Tests:
-----------------------------------------------------------------------------------------------------------------------------
  A100-80GB: 1 GPUs, TP=1
    ‚Üí 1. Model weights (130.39GB per xPU with TP=1) exceed xPU memory (80.0GB). Increase tensor_parallel_size or use larger xPUs.
  H100-80GB: 1 GPUs, TP=1
    ‚Üí 1. Model weights (130.39GB per xPU with TP=1) exceed xPU memory (80.0GB). Increase tensor_parallel_size or use larger xPUs.


üìà TP Scaling Efficiency:
-----------------------------------------------------------------------------------------------------------------------------
  A100-80GB (baseline: 2 GPU, TP=2, 135.3 tok/s):
    4 GPUs, TP=4: 2.85x speedup (142.6% efficiency, ideal: 2.0x)
    8 GPUs, TP=8: 4.22x speedup (105.6% efficiency, ideal: 4.0x)

  H100-80GB (baseline: 2 GPU, TP=2, 232.6 tok/s):
    4 GPUs, TP=4: 3.08x speedup (154.1% efficiency, ideal: 2.0x)
    8 GPUs, TP=8: 4.38x speedup (109.5% efficiency, ideal: 4.0x)

  MI300X (baseline: 1 GPU, TP=1, 449.9 tok/s):
    2 GPUs, TP=2: 2.03x speedup (101.7% efficiency, ideal: 2.0x)
    4 GPUs, TP=4: 2.69x speedup (67.3% efficiency, ideal: 4.0x)
    8 GPUs, TP=8: 2.81x speedup (35.2% efficiency, ideal: 8.0x)

=============================================================================================================================
Summary: 10 succeeded, 2 failed
=============================================================================================================================

Results saved to: results/cluster_benchmark_20251208_180445
=======================================================================
