=======================================================================
LLM Inference Simulator - TP Scaling Benchmark
=======================================================================
Start Time: 2025. 12. 08. (Ïõî) 18:01:45 PST
Random Seed: 4639

‚ö†Ô∏è  Note: Only TP (Tensor Parallelism) is implemented

Configuration:
  Model:           llama2-70b
  xPUs:            a100-80gb h100-80gb mi300x
  Arrival Rate:    10.0 req/s
  Duration:        60.0s

Testing 3 xPUs √ó 4 TP configs = 12 total tests
=======================================================================

-----------------------------------------------------------------------
[1/12] Testing: a100-80gb - TP=1
  Cluster: 1 xPUs (TP=1)
-----------------------------------------------------------------------
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/deckerd/my_projects/inference_sim/llm_inference_simulator/__main__.py", line 219, in <module>
    sys.exit(main())
             ^^^^^^
  File "/home/deckerd/my_projects/inference_sim/llm_inference_simulator/__main__.py", line 203, in main
    config = create_config_from_args(args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/deckerd/my_projects/inference_sim/llm_inference_simulator/__main__.py", line 83, in create_config_from_args
    return SimulatorConfig(
           ^^^^^^^^^^^^^^^^
  File "<string>", line 12, in __init__
  File "/home/deckerd/my_projects/inference_sim/llm_inference_simulator/config.py", line 113, in __post_init__
    self.validate()
  File "/home/deckerd/my_projects/inference_sim/llm_inference_simulator/config.py", line 212, in validate
    raise ValueError(error_msg.strip())
ValueError: Configuration validation failed:
  1. Model weights (130.39GB per xPU with TP=1) exceed xPU memory (80.0GB). Increase tensor_parallel_size or use larger xPUs.
‚úó Failed
  Error: 1. Model weights (130.39GB per xPU with TP=1) exceed xPU memory (80.0GB). Increase tensor_parallel_size or use larger xPUs.

-----------------------------------------------------------------------
[2/12] Testing: a100-80gb - TP=2
  Cluster: 2 xPUs (TP=2)
-----------------------------------------------------------------------

Starting simulation...
Starting simulation...
Configuration: LLaMA-2-70B, 2 xPUs, arrival_rate=10.0 req/s
Memory: 65.19GB model, 14.81GB available for KV cache

Simulation completed at t=60.03s

============================================================
SIMULATION SUMMARY
============================================================

Load Analysis:
  Arrival Rate:         10.0 req/s
  Avg Output Length:    192 tok/req
  Required Throughput:  1920 tok/s
  Actual Throughput:    131.5 tok/s
  Utilization:          1460% ‚ö†Ô∏è  OVERLOAD

------------------------------------------------------------
Metrics Reliability:
  ‚úÖ Throughput:    System capacity (reliable)
  ‚úÖ Completion:    Capacity/Load ratio (reliable)
  ‚ùå TTFT/Latency:  Unreliable (early arrivals only)
------------------------------------------------------------

Requests:
  Total: 609
  Completed: 57

Throughput (= System Capacity):
  Requests/sec: 0.95
  Tokens/sec: 131.52

xPU Utilization: 100.0%

Memory Usage:
  Peak:        79.44GB / 160GB (49.7%)
  P95:         79.35GB / 160GB (49.6%)
  P50 (Med):   76.49GB / 160GB (47.8%)

First Token Latency (‚ö†Ô∏è  Not representative - early arrivals only):
  Mean: 26.4116
  P50:  27.5249
  P90:  50.0116
  P95:  50.4669
  P99:  50.5328

End-to-End Latency (‚ö†Ô∏è  Not representative):
  Mean: 29.8348
  P50:  30.8061
  P90:  49.0865
  P95:  53.2406
  P99:  54.1603

Recommendation:
  System cannot handle workload (14.6x overloaded)
  For stable operation: Reduce arrival to 0.5 req/s (80% util)

============================================================

‚úì Results saved to: results/cluster_benchmark_20251208_180145/a100-80gb_2xpu_tp2.json
‚úì Completed successfully
  Throughput: 131.5 tok/s, Completed: 57, P95 TTFT: 50.47s

-----------------------------------------------------------------------
[3/12] Testing: a100-80gb - TP=4
  Cluster: 4 xPUs (TP=4)
-----------------------------------------------------------------------

Starting simulation...
Starting simulation...
Configuration: LLaMA-2-70B, 4 xPUs, arrival_rate=10.0 req/s
Memory: 32.60GB model, 47.40GB available for KV cache

Simulation completed at t=60.00s

============================================================
SIMULATION SUMMARY
============================================================

Load Analysis:
  Arrival Rate:         10.0 req/s
  Avg Output Length:    192 tok/req
  Required Throughput:  1920 tok/s
  Actual Throughput:    369.0 tok/s
  Utilization:          520% ‚ö†Ô∏è  OVERLOAD

------------------------------------------------------------
Metrics Reliability:
  ‚úÖ Throughput:    System capacity (reliable)
  ‚úÖ Completion:    Capacity/Load ratio (reliable)
  ‚ùå TTFT/Latency:  Unreliable (early arrivals only)
------------------------------------------------------------

Requests:
  Total: 609
  Completed: 166

Throughput (= System Capacity):
  Requests/sec: 2.77
  Tokens/sec: 369.04

xPU Utilization: 100.0%

Memory Usage:
  Peak:        79.50GB / 320GB (24.8%)
  P95:         79.41GB / 320GB (24.8%)
  P50 (Med):   61.00GB / 320GB (19.1%)

First Token Latency (‚ö†Ô∏è  Not representative - early arrivals only):
  Mean: 22.3957
  P50:  21.7170
  P90:  39.3694
  P95:  40.2101
  P99:  40.6141

End-to-End Latency (‚ö†Ô∏è  Not representative):
  Mean: 23.6302
  P50:  25.1249
  P90:  37.4108
  P95:  38.3263
  P99:  41.0486

Recommendation:
  System cannot handle workload (5.2x overloaded)
  For stable operation: Reduce arrival to 1.5 req/s (80% util)

============================================================

‚úì Results saved to: results/cluster_benchmark_20251208_180145/a100-80gb_4xpu_tp4.json
‚úì Completed successfully
  Throughput: 369.0 tok/s, Completed: 166, P95 TTFT: 40.21s

-----------------------------------------------------------------------
[4/12] Testing: a100-80gb - TP=8
  Cluster: 8 xPUs (TP=8)
-----------------------------------------------------------------------

Starting simulation...
Starting simulation...
Configuration: LLaMA-2-70B, 8 xPUs, arrival_rate=10.0 req/s
Memory: 16.30GB model, 63.70GB available for KV cache

Simulation completed at t=60.02s

============================================================
SIMULATION SUMMARY
============================================================

Load Analysis:
  Arrival Rate:         10.0 req/s
  Avg Output Length:    192 tok/req
  Required Throughput:  1920 tok/s
  Actual Throughput:    565.8 tok/s
  Utilization:          339% ‚ö†Ô∏è  OVERLOAD

------------------------------------------------------------
Metrics Reliability:
  ‚úÖ Throughput:    System capacity (reliable)
  ‚úÖ Completion:    Capacity/Load ratio (reliable)
  ‚ùå TTFT/Latency:  Unreliable (early arrivals only)
------------------------------------------------------------

Requests:
  Total: 609
  Completed: 250

Throughput (= System Capacity):
  Requests/sec: 4.17
  Tokens/sec: 565.81

xPU Utilization: 100.0%

Memory Usage:
  Peak:        79.91GB / 640GB (12.5%)
  P95:         79.45GB / 640GB (12.4%)
  P50 (Med):   59.10GB / 640GB (9.2%)

First Token Latency (‚ö†Ô∏è  Not representative - early arrivals only):
  Mean: 16.3818
  P50:  16.0654
  P90:  28.2508
  P95:  30.2868
  P99:  31.5943

End-to-End Latency (‚ö†Ô∏è  Not representative):
  Mean: 18.8213
  P50:  18.8560
  P90:  30.3137
  P95:  31.7487
  P99:  33.6857

Recommendation:
  System cannot handle workload (3.4x overloaded)
  For stable operation: Reduce arrival to 2.4 req/s (80% util)

============================================================

‚úì Results saved to: results/cluster_benchmark_20251208_180145/a100-80gb_8xpu_tp8.json
‚úì Completed successfully
  Throughput: 565.8 tok/s, Completed: 250, P95 TTFT: 30.29s

-----------------------------------------------------------------------
[5/12] Testing: h100-80gb - TP=1
  Cluster: 1 xPUs (TP=1)
-----------------------------------------------------------------------
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/deckerd/my_projects/inference_sim/llm_inference_simulator/__main__.py", line 219, in <module>
    sys.exit(main())
             ^^^^^^
  File "/home/deckerd/my_projects/inference_sim/llm_inference_simulator/__main__.py", line 203, in main
    config = create_config_from_args(args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/deckerd/my_projects/inference_sim/llm_inference_simulator/__main__.py", line 83, in create_config_from_args
    return SimulatorConfig(
           ^^^^^^^^^^^^^^^^
  File "<string>", line 12, in __init__
  File "/home/deckerd/my_projects/inference_sim/llm_inference_simulator/config.py", line 113, in __post_init__
    self.validate()
  File "/home/deckerd/my_projects/inference_sim/llm_inference_simulator/config.py", line 212, in validate
    raise ValueError(error_msg.strip())
ValueError: Configuration validation failed:
  1. Model weights (130.39GB per xPU with TP=1) exceed xPU memory (80.0GB). Increase tensor_parallel_size or use larger xPUs.
‚úó Failed
  Error: 1. Model weights (130.39GB per xPU with TP=1) exceed xPU memory (80.0GB). Increase tensor_parallel_size or use larger xPUs.

-----------------------------------------------------------------------
[6/12] Testing: h100-80gb - TP=2
  Cluster: 2 xPUs (TP=2)
-----------------------------------------------------------------------

Starting simulation...
Starting simulation...
Configuration: LLaMA-2-70B, 2 xPUs, arrival_rate=10.0 req/s
Memory: 65.19GB model, 14.81GB available for KV cache

Simulation completed at t=60.02s

============================================================
SIMULATION SUMMARY
============================================================

Load Analysis:
  Arrival Rate:         10.0 req/s
  Avg Output Length:    192 tok/req
  Required Throughput:  1920 tok/s
  Actual Throughput:    221.9 tok/s
  Utilization:          865% ‚ö†Ô∏è  OVERLOAD

------------------------------------------------------------
Metrics Reliability:
  ‚úÖ Throughput:    System capacity (reliable)
  ‚úÖ Completion:    Capacity/Load ratio (reliable)
  ‚ùå TTFT/Latency:  Unreliable (early arrivals only)
------------------------------------------------------------

Requests:
  Total: 609
  Completed: 102

Throughput (= System Capacity):
  Requests/sec: 1.70
  Tokens/sec: 221.94

xPU Utilization: 100.0%

Memory Usage:
  Peak:        80.00GB / 160GB (50.0%)
  P95:         79.93GB / 160GB (50.0%)
  P50 (Med):   75.28GB / 160GB (47.0%)

First Token Latency (‚ö†Ô∏è  Not representative - early arrivals only):
  Mean: 24.2363
  P50:  24.3268
  P90:  42.7155
  P95:  46.6578
  P99:  47.0747

End-to-End Latency (‚ö†Ô∏è  Not representative):
  Mean: 26.6149
  P50:  26.6853
  P90:  45.0902
  P95:  48.7589
  P99:  50.0317

Recommendation:
  System cannot handle workload (8.7x overloaded)
  For stable operation: Reduce arrival to 0.9 req/s (80% util)

============================================================

‚úì Results saved to: results/cluster_benchmark_20251208_180145/h100-80gb_2xpu_tp2.json
‚úì Completed successfully
  Throughput: 221.9 tok/s, Completed: 102, P95 TTFT: 46.66s

-----------------------------------------------------------------------
[7/12] Testing: h100-80gb - TP=4
  Cluster: 4 xPUs (TP=4)
-----------------------------------------------------------------------

Starting simulation...
Starting simulation...
Configuration: LLaMA-2-70B, 4 xPUs, arrival_rate=10.0 req/s
Memory: 32.60GB model, 47.40GB available for KV cache

Simulation completed at t=60.02s

============================================================
SIMULATION SUMMARY
============================================================

Load Analysis:
  Arrival Rate:         10.0 req/s
  Avg Output Length:    192 tok/req
  Required Throughput:  1920 tok/s
  Actual Throughput:    696.2 tok/s
  Utilization:          276% ‚ö†Ô∏è  OVERLOAD

------------------------------------------------------------
Metrics Reliability:
  ‚úÖ Throughput:    System capacity (reliable)
  ‚úÖ Completion:    Capacity/Load ratio (reliable)
  ‚ùå TTFT/Latency:  Unreliable (early arrivals only)
------------------------------------------------------------

Requests:
  Total: 609
  Completed: 316

Throughput (= System Capacity):
  Requests/sec: 5.27
  Tokens/sec: 696.20

xPU Utilization: 100.0%

Memory Usage:
  Peak:        79.61GB / 320GB (24.9%)
  P95:         79.45GB / 320GB (24.8%)
  P50 (Med):   61.74GB / 320GB (19.3%)

First Token Latency (‚ö†Ô∏è  Not representative - early arrivals only):
  Mean: 13.2062
  P50:  13.4147
  P90:  22.4801
  P95:  24.8961
  P99:  25.4574

End-to-End Latency (‚ö†Ô∏è  Not representative):
  Mean: 15.4219
  P50:  15.5977
  P90:  24.4143
  P95:  26.4244
  P99:  27.6160

Recommendation:
  System cannot handle workload (2.8x overloaded)
  For stable operation: Reduce arrival to 2.9 req/s (80% util)

============================================================

‚úì Results saved to: results/cluster_benchmark_20251208_180145/h100-80gb_4xpu_tp4.json
‚úì Completed successfully
  Throughput: 696.2 tok/s, Completed: 316, P95 TTFT: 24.90s

-----------------------------------------------------------------------
[8/12] Testing: h100-80gb - TP=8
  Cluster: 8 xPUs (TP=8)
-----------------------------------------------------------------------

Starting simulation...
Starting simulation...
Configuration: LLaMA-2-70B, 8 xPUs, arrival_rate=10.0 req/s
Memory: 16.30GB model, 63.70GB available for KV cache

Simulation completed at t=60.02s

============================================================
SIMULATION SUMMARY
============================================================

Load Analysis:
  Arrival Rate:         10.0 req/s
  Avg Output Length:    192 tok/req
  Required Throughput:  1920 tok/s
  Actual Throughput:    997.2 tok/s
  Utilization:          193% ‚ö†Ô∏è  OVERLOAD

------------------------------------------------------------
Metrics Reliability:
  ‚úÖ Throughput:    System capacity (reliable)
  ‚úÖ Completion:    Capacity/Load ratio (reliable)
  ‚ùå TTFT/Latency:  Unreliable (early arrivals only)
------------------------------------------------------------

Requests:
  Total: 609
  Completed: 456

Throughput (= System Capacity):
  Requests/sec: 7.60
  Tokens/sec: 997.22

xPU Utilization: 100.0%

Memory Usage:
  Peak:        79.84GB / 640GB (12.5%)
  P95:         79.73GB / 640GB (12.5%)
  P50 (Med):   50.14GB / 640GB (7.8%)

First Token Latency (‚ö†Ô∏è  Not representative - early arrivals only):
  Mean: 6.5169
  P50:  5.8257
  P90:  12.3330
  P95:  13.4014
  P99:  14.4957

End-to-End Latency (‚ö†Ô∏è  Not representative):
  Mean: 8.6665
  P50:  8.1517
  P90:  14.2239
  P95:  15.1689
  P99:  16.9028

Recommendation:
  System cannot handle workload (1.9x overloaded)
  For stable operation: Reduce arrival to 4.2 req/s (80% util)

============================================================

‚úì Results saved to: results/cluster_benchmark_20251208_180145/h100-80gb_8xpu_tp8.json
‚úì Completed successfully
  Throughput: 997.2 tok/s, Completed: 456, P95 TTFT: 13.40s

-----------------------------------------------------------------------
[9/12] Testing: mi300x - TP=1
  Cluster: 1 xPUs (TP=1)
-----------------------------------------------------------------------

Starting simulation...
Starting simulation...
Configuration: LLaMA-2-70B, 1 xPUs, arrival_rate=10.0 req/s
Memory: 130.39GB model, 61.61GB available for KV cache

Simulation completed at t=60.46s

============================================================
SIMULATION SUMMARY
============================================================

Load Analysis:
  Arrival Rate:         10.0 req/s
  Avg Output Length:    192 tok/req
  Required Throughput:  1920 tok/s
  Actual Throughput:    432.6 tok/s
  Utilization:          444% ‚ö†Ô∏è  OVERLOAD

------------------------------------------------------------
Metrics Reliability:
  ‚úÖ Throughput:    System capacity (reliable)
  ‚úÖ Completion:    Capacity/Load ratio (reliable)
  ‚ùå TTFT/Latency:  Unreliable (early arrivals only)
------------------------------------------------------------

Requests:
  Total: 609
  Completed: 208

Throughput (= System Capacity):
  Requests/sec: 3.44
  Tokens/sec: 432.61

xPU Utilization: 100.0%

Memory Usage:
  Peak:        191.95GB / 192GB (100.0%)
  P95:         191.77GB / 192GB (99.9%)
  P50 (Med):   166.67GB / 192GB (86.8%)

First Token Latency (‚ö†Ô∏è  Not representative - early arrivals only):
  Mean: 18.9473
  P50:  20.0827
  P90:  32.0360
  P95:  33.0615
  P99:  33.6369

End-to-End Latency (‚ö†Ô∏è  Not representative):
  Mean: 22.8719
  P50:  22.7825
  P90:  36.3183
  P95:  37.6157
  P99:  39.0308

Recommendation:
  System cannot handle workload (4.4x overloaded)
  For stable operation: Reduce arrival to 1.8 req/s (80% util)

============================================================

‚úì Results saved to: results/cluster_benchmark_20251208_180145/mi300x_1xpu_tp1.json
‚úì Completed successfully
  Throughput: 432.6 tok/s, Completed: 208, P95 TTFT: 33.06s

-----------------------------------------------------------------------
[10/12] Testing: mi300x - TP=2
  Cluster: 2 xPUs (TP=2)
-----------------------------------------------------------------------

Starting simulation...
Starting simulation...
Configuration: LLaMA-2-70B, 2 xPUs, arrival_rate=10.0 req/s
Memory: 65.19GB model, 126.81GB available for KV cache

Simulation completed at t=62.67s

============================================================
SIMULATION SUMMARY
============================================================

Load Analysis:
  Arrival Rate:         10.0 req/s
  Avg Output Length:    192 tok/req
  Required Throughput:  1920 tok/s
  Actual Throughput:    901.7 tok/s
  Utilization:          213% ‚ö†Ô∏è  OVERLOAD

------------------------------------------------------------
Metrics Reliability:
  ‚úÖ Throughput:    System capacity (reliable)
  ‚úÖ Completion:    Capacity/Load ratio (reliable)
  ‚ùå TTFT/Latency:  Unreliable (early arrivals only)
------------------------------------------------------------

Requests:
  Total: 609
  Completed: 434

Throughput (= System Capacity):
  Requests/sec: 6.93
  Tokens/sec: 901.68

xPU Utilization: 100.0%

Memory Usage:
  Peak:        191.40GB / 384GB (49.8%)
  P95:         191.03GB / 384GB (49.7%)
  P50 (Med):   131.94GB / 384GB (34.4%)

First Token Latency (‚ö†Ô∏è  Not representative - early arrivals only):
  Mean: 8.5693
  P50:  8.4729
  P90:  13.4171
  P95:  15.2867
  P99:  17.1531

End-to-End Latency (‚ö†Ô∏è  Not representative):
  Mean: 12.5485
  P50:  12.6369
  P90:  18.5320
  P95:  19.7832
  P99:  21.6169

Recommendation:
  System cannot handle workload (2.1x overloaded)
  For stable operation: Reduce arrival to 3.8 req/s (80% util)

============================================================

‚úì Results saved to: results/cluster_benchmark_20251208_180145/mi300x_2xpu_tp2.json
‚úì Completed successfully
  Throughput: 901.7 tok/s, Completed: 434, P95 TTFT: 15.29s

-----------------------------------------------------------------------
[11/12] Testing: mi300x - TP=4
  Cluster: 4 xPUs (TP=4)
-----------------------------------------------------------------------

Starting simulation...
Starting simulation...
Configuration: LLaMA-2-70B, 4 xPUs, arrival_rate=10.0 req/s
Memory: 32.60GB model, 159.40GB available for KV cache

Simulation completed at t=60.01s

============================================================
SIMULATION SUMMARY
============================================================

Load Analysis:
  Arrival Rate:         10.0 req/s
  Avg Output Length:    192 tok/req
  Required Throughput:  1920 tok/s
  Actual Throughput:    1189.4 tok/s
  Utilization:          161% ‚ö†Ô∏è  OVERLOAD

------------------------------------------------------------
Metrics Reliability:
  ‚úÖ Throughput:    System capacity (reliable)
  ‚úÖ Completion:    Capacity/Load ratio (reliable)
  ‚ùå TTFT/Latency:  Unreliable (early arrivals only)
------------------------------------------------------------

Requests:
  Total: 609
  Completed: 536

Throughput (= System Capacity):
  Requests/sec: 8.93
  Tokens/sec: 1189.42

xPU Utilization: 100.0%

Memory Usage:
  Peak:        131.23GB / 768GB (17.1%)
  P95:         126.67GB / 768GB (16.5%)
  P50 (Med):   69.90GB / 768GB (9.1%)

First Token Latency (‚ö†Ô∏è  Not representative - early arrivals only):
  Mean: 3.4386
  P50:  3.1771
  P90:  5.8555
  P95:  6.5869
  P99:  7.0717

End-to-End Latency (‚ö†Ô∏è  Not representative):
  Mean: 5.8165
  P50:  5.6103
  P90:  8.5992
  P95:  9.4592
  P99:  10.4970

Recommendation:
  System cannot handle workload (1.6x overloaded)
  For stable operation: Reduce arrival to 5.0 req/s (80% util)

============================================================

‚úì Results saved to: results/cluster_benchmark_20251208_180145/mi300x_4xpu_tp4.json
‚úì Completed successfully
  Throughput: 1189.4 tok/s, Completed: 536, P95 TTFT: 6.59s

-----------------------------------------------------------------------
[12/12] Testing: mi300x - TP=8
  Cluster: 8 xPUs (TP=8)
-----------------------------------------------------------------------

Starting simulation...
Starting simulation...
Configuration: LLaMA-2-70B, 8 xPUs, arrival_rate=10.0 req/s
Memory: 16.30GB model, 175.70GB available for KV cache

Simulation completed at t=60.01s

============================================================
SIMULATION SUMMARY
============================================================

Load Analysis:
  Arrival Rate:         10.0 req/s
  Avg Output Length:    192 tok/req
  Required Throughput:  1920 tok/s
  Actual Throughput:    1264.3 tok/s
  Utilization:          152% ‚ö†Ô∏è  OVERLOAD

------------------------------------------------------------
Metrics Reliability:
  ‚úÖ Throughput:    System capacity (reliable)
  ‚úÖ Completion:    Capacity/Load ratio (reliable)
  ‚ùå TTFT/Latency:  Unreliable (early arrivals only)
------------------------------------------------------------

Requests:
  Total: 609
  Completed: 585

Throughput (= System Capacity):
  Requests/sec: 9.75
  Tokens/sec: 1264.34

xPU Utilization: 100.0%

Memory Usage:
  Peak:        80.46GB / 1536GB (5.2%)
  P95:         63.90GB / 1536GB (4.2%)
  P50 (Med):   34.41GB / 1536GB (2.2%)

First Token Latency (‚ö†Ô∏è  Not representative - early arrivals only):
  Mean: 1.4324
  P50:  1.3430
  P90:  2.4044
  P95:  2.7863
  P99:  3.3278

End-to-End Latency (‚ö†Ô∏è  Not representative):
  Mean: 2.6909
  P50:  2.5889
  P90:  4.0059
  P95:  4.4736
  P99:  5.4759

Recommendation:
  System cannot handle workload (1.5x overloaded)
  For stable operation: Reduce arrival to 5.3 req/s (80% util)

============================================================

‚úì Results saved to: results/cluster_benchmark_20251208_180145/mi300x_8xpu_tp8.json
‚úì Completed successfully
  Throughput: 1264.3 tok/s, Completed: 585, P95 TTFT: 2.79s

=======================================================================
Benchmark Complete!
=======================================================================
End Time: 2025. 12. 08. (Ïõî) 18:01:52 PST

=============================================================================================================================
TP SCALING BENCHMARK REPORT
=============================================================================================================================

Configuration:
-----------------------------------------------------------------------------------------------------------------------------
  Model:           N/A
  xPUs Tested:     N/A
  Workload:        N/A req/s
  Duration:        N/As

Performance & Cost Analysis:
=============================================================================================================================
         xPU  GPUs  TP   Status  Throughput  P95 TTFT     Cost  Efficiency        Cost
                                    (tok/s)     (sec)   ($/hr)   (tok/$/h)   ($/1Mtok)
-----------------------------------------------------------------------------------------------------------------------------
   A100-80GB     1   1   ‚ùå FAIL         N/A       N/A    N/A      N/A         N/A         N/A
   A100-80GB     2   2     ‚úÖ OK       131.5     50.47     7.34        17.9    55810.55
   A100-80GB     4   4     ‚úÖ OK       369.0     40.21    14.68        25.1    39778.86
   A100-80GB     8   8     ‚úÖ OK       565.8     30.29    29.36        19.3    51890.30
   H100-80GB     1   1   ‚ùå FAIL         N/A       N/A    N/A      N/A         N/A         N/A
   H100-80GB     2   2     ‚úÖ OK       221.9     46.66    12.98        17.1    58484.86
   H100-80GB     4   4     ‚úÖ OK       696.2     24.90    25.96        26.8    37288.02
   H100-80GB     8   8     ‚úÖ OK       997.2     13.40    51.92        19.2    52064.66
      MI300X     1   1     ‚úÖ OK       432.6     33.06     7.00        61.8    16180.89
      MI300X     2   2     ‚úÖ OK       901.7     15.29    14.00        64.4    15526.57
      MI300X     4   4     ‚úÖ OK      1189.4      6.59    28.00        42.5    23540.81
      MI300X     8   8     ‚úÖ OK      1264.3      2.79    56.00        22.6    44291.98
-----------------------------------------------------------------------------------------------------------------------------

üèÜ Recommended Configurations:
-----------------------------------------------------------------------------------------------------------------------------
  üí∞ Best Value (tok/$/hour):
     MI300X: 2 GPUs, TP=2
     64.4 tok/$/hour | $15526.57/1M tokens | 901.7 tok/s

  üöÄ Best Performance (throughput):
     MI300X: 8 GPUs, TP=8
     1264.3 tok/s | $56.00/hour | P95 TTFT: 2.79s

  ‚ö° Best Latency (TTFT):
     MI300X: 8 GPUs, TP=8
     P95 TTFT: 2.79s | 1264.3 tok/s | $56.00/hour


‚ùå Failed Tests:
-----------------------------------------------------------------------------------------------------------------------------
  A100-80GB: 1 GPUs, TP=1
    ‚Üí 1. Model weights (130.39GB per xPU with TP=1) exceed xPU memory (80.0GB). Increase tensor_parallel_size or use larger xPUs.
  H100-80GB: 1 GPUs, TP=1
    ‚Üí 1. Model weights (130.39GB per xPU with TP=1) exceed xPU memory (80.0GB). Increase tensor_parallel_size or use larger xPUs.


üìà TP Scaling Efficiency:
-----------------------------------------------------------------------------------------------------------------------------
  A100-80GB (baseline: 2 GPU, TP=2, 131.5 tok/s):
    4 GPUs, TP=4: 2.81x speedup (140.3% efficiency, ideal: 2.0x)
    8 GPUs, TP=8: 4.30x speedup (107.6% efficiency, ideal: 4.0x)

  H100-80GB (baseline: 2 GPU, TP=2, 221.9 tok/s):
    4 GPUs, TP=4: 3.14x speedup (156.8% efficiency, ideal: 2.0x)
    8 GPUs, TP=8: 4.49x speedup (112.3% efficiency, ideal: 4.0x)

  MI300X (baseline: 1 GPU, TP=1, 432.6 tok/s):
    2 GPUs, TP=2: 2.08x speedup (104.2% efficiency, ideal: 2.0x)
    4 GPUs, TP=4: 2.75x speedup (68.7% efficiency, ideal: 4.0x)
    8 GPUs, TP=8: 2.92x speedup (36.5% efficiency, ideal: 8.0x)

=============================================================================================================================
Summary: 10 succeeded, 2 failed
=============================================================================================================================

Results saved to: results/cluster_benchmark_20251208_180145
=======================================================================
