=======================================================================
LLM Inference Simulator - TP Scaling Benchmark
=======================================================================
Start Time: 2025. 12. 08. (Ïõî) 18:03:01 PST
Random Seed: 13754

‚ö†Ô∏è  Note: Only TP (Tensor Parallelism) is implemented

Configuration:
  Model:           llama2-70b
  xPUs:            a100-80gb h100-80gb mi300x
  Arrival Rate:    10.0 req/s
  Duration:        60.0s

Testing 3 xPUs √ó 4 TP configs = 12 total tests
=======================================================================

-----------------------------------------------------------------------
[1/12] Testing: a100-80gb - TP=1
  Cluster: 1 xPUs (TP=1)
-----------------------------------------------------------------------
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/deckerd/my_projects/inference_sim/llm_inference_simulator/__main__.py", line 219, in <module>
    sys.exit(main())
             ^^^^^^
  File "/home/deckerd/my_projects/inference_sim/llm_inference_simulator/__main__.py", line 203, in main
    config = create_config_from_args(args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/deckerd/my_projects/inference_sim/llm_inference_simulator/__main__.py", line 83, in create_config_from_args
    return SimulatorConfig(
           ^^^^^^^^^^^^^^^^
  File "<string>", line 12, in __init__
  File "/home/deckerd/my_projects/inference_sim/llm_inference_simulator/config.py", line 113, in __post_init__
    self.validate()
  File "/home/deckerd/my_projects/inference_sim/llm_inference_simulator/config.py", line 212, in validate
    raise ValueError(error_msg.strip())
ValueError: Configuration validation failed:
  1. Model weights (130.39GB per xPU with TP=1) exceed xPU memory (80.0GB). Increase tensor_parallel_size or use larger xPUs.
‚úó Failed
  Error: 1. Model weights (130.39GB per xPU with TP=1) exceed xPU memory (80.0GB). Increase tensor_parallel_size or use larger xPUs.

-----------------------------------------------------------------------
[2/12] Testing: a100-80gb - TP=2
  Cluster: 2 xPUs (TP=2)
-----------------------------------------------------------------------

Starting simulation...
Starting simulation...
Configuration: LLaMA-2-70B, 2 xPUs, arrival_rate=10.0 req/s
Memory: 65.19GB model, 14.81GB available for KV cache

Simulation completed at t=60.01s

============================================================
SIMULATION SUMMARY
============================================================

Load Analysis:
  Arrival Rate:         10.0 req/s
  Avg Output Length:    192 tok/req
  Required Throughput:  1920 tok/s
  Actual Throughput:    128.7 tok/s
  Utilization:          1492% ‚ö†Ô∏è  OVERLOAD

------------------------------------------------------------
Metrics Reliability:
  ‚úÖ Throughput:    System capacity (reliable)
  ‚úÖ Completion:    Capacity/Load ratio (reliable)
  ‚ùå TTFT/Latency:  Unreliable (early arrivals only)
------------------------------------------------------------

Requests:
  Total: 592
  Completed: 56

Throughput (= System Capacity):
  Requests/sec: 0.93
  Tokens/sec: 128.65

xPU Utilization: 100.0%

Memory Usage:
  Peak:        79.77GB / 160GB (49.9%)
  P95:         79.71GB / 160GB (49.8%)
  P50 (Med):   75.95GB / 160GB (47.5%)

First Token Latency (‚ö†Ô∏è  Not representative - early arrivals only):
  Mean: 27.5579
  P50:  27.8962
  P90:  49.2745
  P95:  49.7500
  P99:  49.9612

End-to-End Latency (‚ö†Ô∏è  Not representative):
  Mean: 31.0438
  P50:  31.8002
  P90:  49.2535
  P95:  52.1752
  P99:  52.6867

Recommendation:
  System cannot handle workload (14.9x overloaded)
  For stable operation: Reduce arrival to 0.5 req/s (80% util)

============================================================

‚úì Results saved to: results/cluster_benchmark_20251208_180301/a100-80gb_2xpu_tp2.json
‚úì Completed successfully
  Throughput: 128.7 tok/s, Completed: 56, P95 TTFT: 49.75s

-----------------------------------------------------------------------
[3/12] Testing: a100-80gb - TP=4
  Cluster: 4 xPUs (TP=4)
-----------------------------------------------------------------------

Starting simulation...
Starting simulation...
Configuration: LLaMA-2-70B, 4 xPUs, arrival_rate=10.0 req/s
Memory: 32.60GB model, 47.40GB available for KV cache

Simulation completed at t=61.66s

============================================================
SIMULATION SUMMARY
============================================================

Load Analysis:
  Arrival Rate:         10.0 req/s
  Avg Output Length:    192 tok/req
  Required Throughput:  1920 tok/s
  Actual Throughput:    376.5 tok/s
  Utilization:          510% ‚ö†Ô∏è  OVERLOAD

------------------------------------------------------------
Metrics Reliability:
  ‚úÖ Throughput:    System capacity (reliable)
  ‚úÖ Completion:    Capacity/Load ratio (reliable)
  ‚ùå TTFT/Latency:  Unreliable (early arrivals only)
------------------------------------------------------------

Requests:
  Total: 592
  Completed: 175

Throughput (= System Capacity):
  Requests/sec: 2.84
  Tokens/sec: 376.46

xPU Utilization: 100.0%

Memory Usage:
  Peak:        79.92GB / 320GB (25.0%)
  P95:         79.77GB / 320GB (24.9%)
  P50 (Med):   66.79GB / 320GB (20.9%)

First Token Latency (‚ö†Ô∏è  Not representative - early arrivals only):
  Mean: 18.9307
  P50:  17.2188
  P90:  34.7463
  P95:  35.5888
  P99:  36.3853

End-to-End Latency (‚ö†Ô∏è  Not representative):
  Mean: 23.6400
  P50:  23.1072
  P90:  39.2929
  P95:  41.2534
  P99:  42.5484

Recommendation:
  System cannot handle workload (5.1x overloaded)
  For stable operation: Reduce arrival to 1.6 req/s (80% util)

============================================================

‚úì Results saved to: results/cluster_benchmark_20251208_180301/a100-80gb_4xpu_tp4.json
‚úì Completed successfully
  Throughput: 376.5 tok/s, Completed: 175, P95 TTFT: 35.59s

-----------------------------------------------------------------------
[4/12] Testing: a100-80gb - TP=8
  Cluster: 8 xPUs (TP=8)
-----------------------------------------------------------------------

Starting simulation...
Starting simulation...
Configuration: LLaMA-2-70B, 8 xPUs, arrival_rate=10.0 req/s
Memory: 16.30GB model, 63.70GB available for KV cache

Simulation completed at t=60.72s

============================================================
SIMULATION SUMMARY
============================================================

Load Analysis:
  Arrival Rate:         10.0 req/s
  Avg Output Length:    192 tok/req
  Required Throughput:  1920 tok/s
  Actual Throughput:    563.0 tok/s
  Utilization:          341% ‚ö†Ô∏è  OVERLOAD

------------------------------------------------------------
Metrics Reliability:
  ‚úÖ Throughput:    System capacity (reliable)
  ‚úÖ Completion:    Capacity/Load ratio (reliable)
  ‚ùå TTFT/Latency:  Unreliable (early arrivals only)
------------------------------------------------------------

Requests:
  Total: 592
  Completed: 260

Throughput (= System Capacity):
  Requests/sec: 4.28
  Tokens/sec: 562.97

xPU Utilization: 100.0%

Memory Usage:
  Peak:        79.72GB / 640GB (12.5%)
  P95:         79.60GB / 640GB (12.4%)
  P50 (Med):   57.22GB / 640GB (8.9%)

First Token Latency (‚ö†Ô∏è  Not representative - early arrivals only):
  Mean: 14.7927
  P50:  14.2242
  P90:  26.3708
  P95:  27.5814
  P99:  29.2649

End-to-End Latency (‚ö†Ô∏è  Not representative):
  Mean: 19.3785
  P50:  18.7692
  P90:  31.6367
  P95:  32.8545
  P99:  34.6036

Recommendation:
  System cannot handle workload (3.4x overloaded)
  For stable operation: Reduce arrival to 2.3 req/s (80% util)

============================================================

‚úì Results saved to: results/cluster_benchmark_20251208_180301/a100-80gb_8xpu_tp8.json
‚úì Completed successfully
  Throughput: 563.0 tok/s, Completed: 260, P95 TTFT: 27.58s

-----------------------------------------------------------------------
[5/12] Testing: h100-80gb - TP=1
  Cluster: 1 xPUs (TP=1)
-----------------------------------------------------------------------
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/deckerd/my_projects/inference_sim/llm_inference_simulator/__main__.py", line 219, in <module>
    sys.exit(main())
             ^^^^^^
  File "/home/deckerd/my_projects/inference_sim/llm_inference_simulator/__main__.py", line 203, in main
    config = create_config_from_args(args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/deckerd/my_projects/inference_sim/llm_inference_simulator/__main__.py", line 83, in create_config_from_args
    return SimulatorConfig(
           ^^^^^^^^^^^^^^^^
  File "<string>", line 12, in __init__
  File "/home/deckerd/my_projects/inference_sim/llm_inference_simulator/config.py", line 113, in __post_init__
    self.validate()
  File "/home/deckerd/my_projects/inference_sim/llm_inference_simulator/config.py", line 212, in validate
    raise ValueError(error_msg.strip())
ValueError: Configuration validation failed:
  1. Model weights (130.39GB per xPU with TP=1) exceed xPU memory (80.0GB). Increase tensor_parallel_size or use larger xPUs.
‚úó Failed
  Error: 1. Model weights (130.39GB per xPU with TP=1) exceed xPU memory (80.0GB). Increase tensor_parallel_size or use larger xPUs.

-----------------------------------------------------------------------
[6/12] Testing: h100-80gb - TP=2
  Cluster: 2 xPUs (TP=2)
-----------------------------------------------------------------------

Starting simulation...
Starting simulation...
Configuration: LLaMA-2-70B, 2 xPUs, arrival_rate=10.0 req/s
Memory: 65.19GB model, 14.81GB available for KV cache

Simulation completed at t=60.02s

============================================================
SIMULATION SUMMARY
============================================================

Load Analysis:
  Arrival Rate:         10.0 req/s
  Avg Output Length:    192 tok/req
  Required Throughput:  1920 tok/s
  Actual Throughput:    222.6 tok/s
  Utilization:          862% ‚ö†Ô∏è  OVERLOAD

------------------------------------------------------------
Metrics Reliability:
  ‚úÖ Throughput:    System capacity (reliable)
  ‚úÖ Completion:    Capacity/Load ratio (reliable)
  ‚ùå TTFT/Latency:  Unreliable (early arrivals only)
------------------------------------------------------------

Requests:
  Total: 592
  Completed: 101

Throughput (= System Capacity):
  Requests/sec: 1.68
  Tokens/sec: 222.64

xPU Utilization: 100.0%

Memory Usage:
  Peak:        79.77GB / 160GB (49.9%)
  P95:         79.71GB / 160GB (49.8%)
  P50 (Med):   75.53GB / 160GB (47.2%)

First Token Latency (‚ö†Ô∏è  Not representative - early arrivals only):
  Mean: 24.2541
  P50:  25.1617
  P90:  40.6190
  P95:  44.8103
  P99:  45.1493

End-to-End Latency (‚ö†Ô∏è  Not representative):
  Mean: 26.6619
  P50:  27.1036
  P90:  42.0663
  P95:  46.6290
  P99:  48.6208

Recommendation:
  System cannot handle workload (8.6x overloaded)
  For stable operation: Reduce arrival to 0.9 req/s (80% util)

============================================================

‚úì Results saved to: results/cluster_benchmark_20251208_180301/h100-80gb_2xpu_tp2.json
‚úì Completed successfully
  Throughput: 222.6 tok/s, Completed: 101, P95 TTFT: 44.81s

-----------------------------------------------------------------------
[7/12] Testing: h100-80gb - TP=4
  Cluster: 4 xPUs (TP=4)
-----------------------------------------------------------------------

Starting simulation...
Starting simulation...
Configuration: LLaMA-2-70B, 4 xPUs, arrival_rate=10.0 req/s
Memory: 32.60GB model, 47.40GB available for KV cache

Simulation completed at t=60.00s

============================================================
SIMULATION SUMMARY
============================================================

Load Analysis:
  Arrival Rate:         10.0 req/s
  Avg Output Length:    192 tok/req
  Required Throughput:  1920 tok/s
  Actual Throughput:    715.1 tok/s
  Utilization:          268% ‚ö†Ô∏è  OVERLOAD

------------------------------------------------------------
Metrics Reliability:
  ‚úÖ Throughput:    System capacity (reliable)
  ‚úÖ Completion:    Capacity/Load ratio (reliable)
  ‚ùå TTFT/Latency:  Unreliable (early arrivals only)
------------------------------------------------------------

Requests:
  Total: 592
  Completed: 318

Throughput (= System Capacity):
  Requests/sec: 5.30
  Tokens/sec: 715.14

xPU Utilization: 100.0%

Memory Usage:
  Peak:        80.00GB / 320GB (25.0%)
  P95:         79.61GB / 320GB (24.9%)
  P50 (Med):   64.94GB / 320GB (20.3%)

First Token Latency (‚ö†Ô∏è  Not representative - early arrivals only):
  Mean: 13.0550
  P50:  13.4284
  P90:  23.2569
  P95:  24.5018
  P99:  26.3446

End-to-End Latency (‚ö†Ô∏è  Not representative):
  Mean: 14.8664
  P50:  15.2084
  P90:  23.7924
  P95:  25.0940
  P99:  26.7845

Recommendation:
  System cannot handle workload (2.7x overloaded)
  For stable operation: Reduce arrival to 3.0 req/s (80% util)

============================================================

‚úì Results saved to: results/cluster_benchmark_20251208_180301/h100-80gb_4xpu_tp4.json
‚úì Completed successfully
  Throughput: 715.1 tok/s, Completed: 318, P95 TTFT: 24.50s

-----------------------------------------------------------------------
[8/12] Testing: h100-80gb - TP=8
  Cluster: 8 xPUs (TP=8)
-----------------------------------------------------------------------

Starting simulation...
Starting simulation...
Configuration: LLaMA-2-70B, 8 xPUs, arrival_rate=10.0 req/s
Memory: 16.30GB model, 63.70GB available for KV cache

Simulation completed at t=60.02s

============================================================
SIMULATION SUMMARY
============================================================

Load Analysis:
  Arrival Rate:         10.0 req/s
  Avg Output Length:    192 tok/req
  Required Throughput:  1920 tok/s
  Actual Throughput:    993.5 tok/s
  Utilization:          193% ‚ö†Ô∏è  OVERLOAD

------------------------------------------------------------
Metrics Reliability:
  ‚úÖ Throughput:    System capacity (reliable)
  ‚úÖ Completion:    Capacity/Load ratio (reliable)
  ‚ùå TTFT/Latency:  Unreliable (early arrivals only)
------------------------------------------------------------

Requests:
  Total: 592
  Completed: 454

Throughput (= System Capacity):
  Requests/sec: 7.56
  Tokens/sec: 993.53

xPU Utilization: 100.0%

Memory Usage:
  Peak:        79.82GB / 640GB (12.5%)
  P95:         79.14GB / 640GB (12.4%)
  P50 (Med):   50.35GB / 640GB (7.9%)

First Token Latency (‚ö†Ô∏è  Not representative - early arrivals only):
  Mean: 6.1393
  P50:  6.1672
  P90:  10.5935
  P95:  11.2691
  P99:  12.5415

End-to-End Latency (‚ö†Ô∏è  Not representative):
  Mean: 8.3422
  P50:  8.6349
  P90:  12.7346
  P95:  13.4729
  P99:  14.3268

Recommendation:
  System cannot handle workload (1.9x overloaded)
  For stable operation: Reduce arrival to 4.1 req/s (80% util)

============================================================

‚úì Results saved to: results/cluster_benchmark_20251208_180301/h100-80gb_8xpu_tp8.json
‚úì Completed successfully
  Throughput: 993.5 tok/s, Completed: 454, P95 TTFT: 11.27s

-----------------------------------------------------------------------
[9/12] Testing: mi300x - TP=1
  Cluster: 1 xPUs (TP=1)
-----------------------------------------------------------------------

Starting simulation...
Starting simulation...
Configuration: LLaMA-2-70B, 1 xPUs, arrival_rate=10.0 req/s
Memory: 130.39GB model, 61.61GB available for KV cache

Simulation completed at t=60.02s

============================================================
SIMULATION SUMMARY
============================================================

Load Analysis:
  Arrival Rate:         10.0 req/s
  Avg Output Length:    192 tok/req
  Required Throughput:  1920 tok/s
  Actual Throughput:    480.5 tok/s
  Utilization:          400% ‚ö†Ô∏è  OVERLOAD

------------------------------------------------------------
Metrics Reliability:
  ‚úÖ Throughput:    System capacity (reliable)
  ‚úÖ Completion:    Capacity/Load ratio (reliable)
  ‚ùå TTFT/Latency:  Unreliable (early arrivals only)
------------------------------------------------------------

Requests:
  Total: 592
  Completed: 218

Throughput (= System Capacity):
  Requests/sec: 3.63
  Tokens/sec: 480.51

xPU Utilization: 100.0%

Memory Usage:
  Peak:        191.91GB / 192GB (100.0%)
  P95:         191.68GB / 192GB (99.8%)
  P50 (Med):   173.02GB / 192GB (90.1%)

First Token Latency (‚ö†Ô∏è  Not representative - early arrivals only):
  Mean: 18.2880
  P50:  16.5991
  P90:  33.0691
  P95:  33.9765
  P99:  34.4710

End-to-End Latency (‚ö†Ô∏è  Not representative):
  Mean: 22.3831
  P50:  21.9585
  P90:  36.7800
  P95:  37.6463
  P99:  39.2259

Recommendation:
  System cannot handle workload (4.0x overloaded)
  For stable operation: Reduce arrival to 2.0 req/s (80% util)

============================================================

‚úì Results saved to: results/cluster_benchmark_20251208_180301/mi300x_1xpu_tp1.json
‚úì Completed successfully
  Throughput: 480.5 tok/s, Completed: 218, P95 TTFT: 33.98s

-----------------------------------------------------------------------
[10/12] Testing: mi300x - TP=2
  Cluster: 2 xPUs (TP=2)
-----------------------------------------------------------------------

Starting simulation...
Starting simulation...
Configuration: LLaMA-2-70B, 2 xPUs, arrival_rate=10.0 req/s
Memory: 65.19GB model, 126.81GB available for KV cache

Simulation completed at t=61.19s

============================================================
SIMULATION SUMMARY
============================================================

Load Analysis:
  Arrival Rate:         10.0 req/s
  Avg Output Length:    192 tok/req
  Required Throughput:  1920 tok/s
  Actual Throughput:    886.6 tok/s
  Utilization:          217% ‚ö†Ô∏è  OVERLOAD

------------------------------------------------------------
Metrics Reliability:
  ‚úÖ Throughput:    System capacity (reliable)
  ‚úÖ Completion:    Capacity/Load ratio (reliable)
  ‚ùå TTFT/Latency:  Unreliable (early arrivals only)
------------------------------------------------------------

Requests:
  Total: 592
  Completed: 425

Throughput (= System Capacity):
  Requests/sec: 6.95
  Tokens/sec: 886.59

xPU Utilization: 100.0%

Memory Usage:
  Peak:        191.67GB / 384GB (49.9%)
  P95:         191.26GB / 384GB (49.8%)
  P50 (Med):   121.39GB / 384GB (31.6%)

First Token Latency (‚ö†Ô∏è  Not representative - early arrivals only):
  Mean: 8.3886
  P50:  8.4210
  P90:  13.2886
  P95:  14.2518
  P99:  16.4391

End-to-End Latency (‚ö†Ô∏è  Not representative):
  Mean: 12.2114
  P50:  12.5835
  P90:  17.6723
  P95:  18.7925
  P99:  20.3767

Recommendation:
  System cannot handle workload (2.2x overloaded)
  For stable operation: Reduce arrival to 3.7 req/s (80% util)

============================================================

‚úì Results saved to: results/cluster_benchmark_20251208_180301/mi300x_2xpu_tp2.json
‚úì Completed successfully
  Throughput: 886.6 tok/s, Completed: 425, P95 TTFT: 14.25s

-----------------------------------------------------------------------
[11/12] Testing: mi300x - TP=4
  Cluster: 4 xPUs (TP=4)
-----------------------------------------------------------------------

Starting simulation...
Starting simulation...
Configuration: LLaMA-2-70B, 4 xPUs, arrival_rate=10.0 req/s
Memory: 32.60GB model, 159.40GB available for KV cache

Simulation completed at t=60.02s

============================================================
SIMULATION SUMMARY
============================================================

Load Analysis:
  Arrival Rate:         10.0 req/s
  Avg Output Length:    192 tok/req
  Required Throughput:  1920 tok/s
  Actual Throughput:    1141.8 tok/s
  Utilization:          168% ‚ö†Ô∏è  OVERLOAD

------------------------------------------------------------
Metrics Reliability:
  ‚úÖ Throughput:    System capacity (reliable)
  ‚úÖ Completion:    Capacity/Load ratio (reliable)
  ‚ùå TTFT/Latency:  Unreliable (early arrivals only)
------------------------------------------------------------

Requests:
  Total: 592
  Completed: 522

Throughput (= System Capacity):
  Requests/sec: 8.70
  Tokens/sec: 1141.85

xPU Utilization: 100.0%

Memory Usage:
  Peak:        116.46GB / 768GB (15.2%)
  P95:         109.59GB / 768GB (14.3%)
  P50 (Med):   67.26GB / 768GB (8.8%)

First Token Latency (‚ö†Ô∏è  Not representative - early arrivals only):
  Mean: 3.1251
  P50:  2.9961
  P90:  5.2265
  P95:  5.6125
  P99:  5.9092

End-to-End Latency (‚ö†Ô∏è  Not representative):
  Mean: 5.2549
  P50:  5.0652
  P90:  7.7899
  P95:  8.2744
  P99:  8.8998

Recommendation:
  System cannot handle workload (1.7x overloaded)
  For stable operation: Reduce arrival to 4.8 req/s (80% util)

============================================================

‚úì Results saved to: results/cluster_benchmark_20251208_180301/mi300x_4xpu_tp4.json
‚úì Completed successfully
  Throughput: 1141.8 tok/s, Completed: 522, P95 TTFT: 5.61s

-----------------------------------------------------------------------
[12/12] Testing: mi300x - TP=8
  Cluster: 8 xPUs (TP=8)
-----------------------------------------------------------------------

Starting simulation...
Starting simulation...
Configuration: LLaMA-2-70B, 8 xPUs, arrival_rate=10.0 req/s
Memory: 16.30GB model, 175.70GB available for KV cache

Simulation completed at t=60.01s

============================================================
SIMULATION SUMMARY
============================================================

Load Analysis:
  Arrival Rate:         10.0 req/s
  Avg Output Length:    192 tok/req
  Required Throughput:  1920 tok/s
  Actual Throughput:    1218.8 tok/s
  Utilization:          158% ‚ö†Ô∏è  OVERLOAD

------------------------------------------------------------
Metrics Reliability:
  ‚úÖ Throughput:    System capacity (reliable)
  ‚úÖ Completion:    Capacity/Load ratio (reliable)
  ‚ùå TTFT/Latency:  Unreliable (early arrivals only)
------------------------------------------------------------

Requests:
  Total: 592
  Completed: 563

Throughput (= System Capacity):
  Requests/sec: 9.38
  Tokens/sec: 1218.80

xPU Utilization: 100.0%

Memory Usage:
  Peak:        65.33GB / 1536GB (4.3%)
  P95:         52.36GB / 1536GB (3.4%)
  P50 (Med):   33.90GB / 1536GB (2.2%)

First Token Latency (‚ö†Ô∏è  Not representative - early arrivals only):
  Mean: 1.3327
  P50:  1.3120
  P90:  2.1489
  P95:  2.3292
  P99:  2.7556

End-to-End Latency (‚ö†Ô∏è  Not representative):
  Mean: 2.4524
  P50:  2.4059
  P90:  3.5449
  P95:  3.7783
  P99:  4.1097

Recommendation:
  System cannot handle workload (1.6x overloaded)
  For stable operation: Reduce arrival to 5.1 req/s (80% util)

============================================================

‚úì Results saved to: results/cluster_benchmark_20251208_180301/mi300x_8xpu_tp8.json
‚úì Completed successfully
  Throughput: 1218.8 tok/s, Completed: 563, P95 TTFT: 2.33s

=======================================================================
Benchmark Complete!
=======================================================================
End Time: 2025. 12. 08. (Ïõî) 18:03:08 PST

=============================================================================================================================
TP SCALING BENCHMARK REPORT
=============================================================================================================================

Configuration:
-----------------------------------------------------------------------------------------------------------------------------
  Model:           N/A
  xPUs Tested:     N/A
  Workload:        N/A req/s
  Duration:        N/As

Performance & Cost Analysis:
=============================================================================================================================
         xPU  GPUs  TP   Status  Throughput  P95 TTFT     Cost  Efficiency        Cost
                                    (tok/s)     (sec)   ($/hr)   (tok/$/h)   ($/1Mtok)
-----------------------------------------------------------------------------------------------------------------------------
   A100-80GB     1   1   ‚ùå FAIL         N/A       N/A    N/A      N/A         N/A         N/A
   A100-80GB     2   2     ‚úÖ OK       128.7     49.75     7.34        17.5    57052.41
   A100-80GB     4   4     ‚úÖ OK       376.5     35.59    14.68        25.6    38994.75
   A100-80GB     8   8     ‚úÖ OK       563.0     27.58    29.36        19.2    52152.44
   H100-80GB     1   1   ‚ùå FAIL         N/A       N/A    N/A      N/A         N/A         N/A
   H100-80GB     2   2     ‚úÖ OK       222.6     44.81    12.98        17.2    58300.86
   H100-80GB     4   4     ‚úÖ OK       715.1     24.50    25.96        27.5    36300.46
   H100-80GB     8   8     ‚úÖ OK       993.5     11.27    51.92        19.1    52257.90
      MI300X     1   1     ‚úÖ OK       480.5     33.98     7.00        68.6    14567.93
      MI300X     2   2     ‚úÖ OK       886.6     14.25    14.00        63.3    15790.78
      MI300X     4   4     ‚úÖ OK      1141.8      5.61    28.00        40.8    24521.63
      MI300X     8   8     ‚úÖ OK      1218.8      2.33    56.00        21.8    45946.68
-----------------------------------------------------------------------------------------------------------------------------

üèÜ Recommended Configurations:
-----------------------------------------------------------------------------------------------------------------------------
  üí∞ Best Value (tok/$/hour):
     MI300X: 1 GPUs, TP=1
     68.6 tok/$/hour | $14567.93/1M tokens | 480.5 tok/s

  üöÄ Best Performance (throughput):
     MI300X: 8 GPUs, TP=8
     1218.8 tok/s | $56.00/hour | P95 TTFT: 2.33s

  ‚ö° Best Latency (TTFT):
     MI300X: 8 GPUs, TP=8
     P95 TTFT: 2.33s | 1218.8 tok/s | $56.00/hour


‚ùå Failed Tests:
-----------------------------------------------------------------------------------------------------------------------------
  A100-80GB: 1 GPUs, TP=1
    ‚Üí 1. Model weights (130.39GB per xPU with TP=1) exceed xPU memory (80.0GB). Increase tensor_parallel_size or use larger xPUs.
  H100-80GB: 1 GPUs, TP=1
    ‚Üí 1. Model weights (130.39GB per xPU with TP=1) exceed xPU memory (80.0GB). Increase tensor_parallel_size or use larger xPUs.


üìà TP Scaling Efficiency:
-----------------------------------------------------------------------------------------------------------------------------
  A100-80GB (baseline: 2 GPU, TP=2, 128.7 tok/s):
    4 GPUs, TP=4: 2.93x speedup (146.3% efficiency, ideal: 2.0x)
    8 GPUs, TP=8: 4.38x speedup (109.4% efficiency, ideal: 4.0x)

  H100-80GB (baseline: 2 GPU, TP=2, 222.6 tok/s):
    4 GPUs, TP=4: 3.21x speedup (160.6% efficiency, ideal: 2.0x)
    8 GPUs, TP=8: 4.46x speedup (111.6% efficiency, ideal: 4.0x)

  MI300X (baseline: 1 GPU, TP=1, 480.5 tok/s):
    2 GPUs, TP=2: 1.85x speedup (92.3% efficiency, ideal: 2.0x)
    4 GPUs, TP=4: 2.38x speedup (59.4% efficiency, ideal: 4.0x)
    8 GPUs, TP=8: 2.54x speedup (31.7% efficiency, ideal: 8.0x)

=============================================================================================================================
Summary: 10 succeeded, 2 failed
=============================================================================================================================

Results saved to: results/cluster_benchmark_20251208_180301
=======================================================================
